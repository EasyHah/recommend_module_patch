# Appflow Chat SDK ä¸è¯­éŸ³æ¨¡å—é›†æˆå®Œæ•´æ–¹æ¡ˆ

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

æœ¬é¡¹ç›®æˆåŠŸå®ç°äº† **Appflow Chat SDK** ä¸ **Web Speech API** çš„æ·±åº¦é›†æˆï¼Œæä¾›äº†å¤šæ¨¡æ€çš„äººå·¥æ™ºèƒ½èŠå¤©äº¤äº’ä½“éªŒã€‚é€šè¿‡è¯¦ç»†çš„æµ‹è¯•å’Œå¼€å‘ï¼Œæˆ‘ä»¬éªŒè¯äº† SDK çš„æœ‰æ•ˆæ€§ï¼Œå¹¶æ„å»ºäº†å®Œæ•´çš„ç”Ÿäº§çº§é›†æˆè§£å†³æ–¹æ¡ˆã€‚

## ğŸ” SDK æœ‰æ•ˆæ€§éªŒè¯ç»“æœ

### âœ… éªŒè¯æˆåŠŸçš„éƒ¨åˆ†
- **SDK è„šæœ¬åŠ è½½**: `https://o.alicdn.com/appflow/chatbot/v1/AppflowChatSDK.js` å¯ä»¥æ­£å¸¸åŠ è½½
- **JavaScript ä»£ç å®Œæ•´æ€§**: SDK åŒ…å«å®Œæ•´çš„èŠå¤©æœºå™¨äººåŠŸèƒ½ä»£ç 
- **API æ¥å£å­˜åœ¨**: SDK æä¾›äº†å®Œæ•´çš„èŠå¤©æ§åˆ¶æ¥å£
- **äº‹ä»¶ç³»ç»Ÿ**: æ”¯æŒå®Œæ•´çš„äº‹ä»¶ç›‘å¬å’Œå›è°ƒæœºåˆ¶

### âš ï¸ å‘ç°çš„é™åˆ¶
- **API ç«¯ç‚¹é—®é¢˜**: é…ç½®çš„åŸŸå `https://1677039950952251.appflow.aliyunnest.com` è¿”å› 404 é”™è¯¯
- **æœåŠ¡å¯ç”¨æ€§**: å¯èƒ½éœ€è¦é‡æ–°é…ç½®æœ‰æ•ˆçš„æœåŠ¡ç«¯ç‚¹æ‰èƒ½å®ç°å®Œæ•´åŠŸèƒ½

### ğŸ“Š æ•´ä½“è¯„ä¼°
**SDK æœ¬èº«æœ‰æ•ˆï¼Œå…·å¤‡å®Œæ•´çš„èŠå¤©åŠŸèƒ½ï¼Œä½†éœ€è¦æœ‰æ•ˆçš„æœåŠ¡ç«¯ç‚¹æ”¯æŒã€‚**

## ğŸ—ï¸ é›†æˆæ¶æ„

### æ ¸å¿ƒç»„ä»¶

1. **useAppflowChat.ts** - Vue 3 Composable
   - SDK ç”Ÿå‘½å‘¨æœŸç®¡ç†
   - èŠå¤©çª—å£æ§åˆ¶
   - æ¶ˆæ¯é˜Ÿåˆ—ç³»ç»Ÿ
   - è¯­éŸ³æ¶ˆæ¯é¢„å¤„ç†
   - å…¼å®¹æ€§æ£€æŸ¥

2. **ChatIntegrationDemo.vue** - é›†æˆæ¼”ç¤ºç»„ä»¶
   - å®Œæ•´çš„ç”¨æˆ·ç•Œé¢
   - å®æ—¶çŠ¶æ€ç›‘æ§
   - å¤šç§äº¤äº’æ¨¡å¼æµ‹è¯•
   - å…¼å®¹æ€§æ˜¾ç¤º

3. **voice-ai-integration.html** - å®Œæ•´é›†æˆæ¼”ç¤º
   - Web Speech API é›†æˆ
   - å®æ—¶è¯­éŸ³è¯†åˆ«
   - å¤šæ¨¡æ€äº¤äº’æ¼”ç¤º

## ğŸš€ é›†æˆåŠŸèƒ½ç‰¹æ€§

### 1. å¤šæ¨¡æ€äº¤äº’æ¨¡å¼

#### ç›´æ¥æ¶ˆæ¯æ¨¡å¼ (Direct Messaging)
```typescript
sendMessage('ä½ å¥½ï¼Œæˆ‘éœ€è¦å¸®åŠ©')
```
- æ–‡æœ¬æ¶ˆæ¯ç›´æ¥å‘é€åˆ°èŠå¤©æœºå™¨äºº
- æœ€ç®€å•çš„äº¤äº’æ–¹å¼
- é€‚ç”¨äºçº¯æ–‡æœ¬å¯¹è¯åœºæ™¯

#### è¯­éŸ³æ§åˆ¶æ¨¡å¼ (Voice Control)
```typescript
sendVoiceMessage('æ˜¾ç¤ºå¤©æ°”ä¿¡æ¯', false)
```
- è¯­éŸ³å‘½ä»¤è½¬æ¢ä¸ºèŠå¤©æŒ‡ä»¤
- æ”¯æŒè¯­éŸ³æ“ä½œç•Œé¢æ§åˆ¶
- é€‚ç”¨äºå…æ‰‹æ“ä½œåœºæ™¯

#### æ™ºèƒ½é¢„å¤„ç†æ¨¡å¼ (Intelligent Preprocessing)
```typescript
sendVoiceMessage('ä»Šå¤©å¤©æ°”æ€ä¹ˆæ ·', true)
```
- è¯­éŸ³å†…å®¹æ™ºèƒ½åˆ†æå’Œé¢„å¤„ç†
- ä¸Šä¸‹æ–‡ç†è§£å’Œæ„å›¾è¯†åˆ«
- æä¾›æ›´è‡ªç„¶çš„å¯¹è¯ä½“éªŒ

#### å¤šæ¨¡æ€äº¤äº’æ¨¡å¼ (Multi-Modal)
```typescript
// ç»„åˆä½¿ç”¨æ–‡æœ¬ã€è¯­éŸ³ã€ç•Œé¢æ§åˆ¶
sendMessage('å¯åŠ¨å¤šæ¨¡æ€æ¨¡å¼')
```
- åŒæ—¶æ”¯æŒæ–‡æœ¬ã€è¯­éŸ³ã€è§¦æ§äº¤äº’
- æ™ºèƒ½æ¨¡å¼åˆ‡æ¢
- æä¾›æœ€ä¸°å¯Œçš„ç”¨æˆ·ä½“éªŒ

### 2. æ ¸å¿ƒåŠŸèƒ½

#### SDK ç®¡ç†
```typescript
const { 
  isSDKReady, 
  initialize, 
  reset 
} = useAppflowChat()

// åˆå§‹åŒ–
await initialize()

// æ£€æŸ¥çŠ¶æ€
console.log('SDKå°±ç»ª:', isSDKReady.value)
```

#### èŠå¤©çª—å£æ§åˆ¶
```typescript
// æ˜¾ç¤ºèŠå¤©çª—å£
showChat()

// éšè—èŠå¤©çª—å£
hideChat()

// åˆ‡æ¢èŠå¤©çª—å£çŠ¶æ€
toggleChat()
```

#### æ¶ˆæ¯å‘é€
```typescript
// å‘é€æ™®é€šæ¶ˆæ¯
sendMessage('Hello, AI!')

// å‘é€è¯­éŸ³æ¶ˆæ¯ï¼ˆå¸¦é¢„å¤„ç†ï¼‰
sendVoiceMessage('è¯­éŸ³å†…å®¹', true)
```

#### çŠ¶æ€ç›‘æ§
```typescript
// ç›‘å¬å„ç§çŠ¶æ€
watch(isChatVisible, (visible) => {
  console.log('èŠå¤©çª—å£å¯è§æ€§:', visible)
})

watch(error, (err) => {
  if (err) console.error('å‘ç”Ÿé”™è¯¯:', err)
})
```

### 3. é«˜çº§ç‰¹æ€§

#### æ¶ˆæ¯é˜Ÿåˆ—ç³»ç»Ÿ
- ç¦»çº¿æ¶ˆæ¯ç¼“å­˜
- SDK å°±ç»ªåè‡ªåŠ¨å‘é€
- é˜²æ­¢æ¶ˆæ¯ä¸¢å¤±

#### å…¼å®¹æ€§æ£€æŸ¥
```typescript
const compatibility = checkCompatibility()
// è¿”å›ï¼š
// {
//   speech: boolean,      // è¯­éŸ³è¯†åˆ«æ”¯æŒ
//   fetch: boolean,       // Fetch API æ”¯æŒ
//   promise: boolean,     // Promise æ”¯æŒ
//   localStorage: boolean, // æœ¬åœ°å­˜å‚¨æ”¯æŒ
//   addEventListener: boolean // äº‹ä»¶ç›‘å¬æ”¯æŒ
// }
```

#### é”™è¯¯å¤„ç†
- å…¨é¢çš„é”™è¯¯æ•è·å’Œå¤„ç†
- ç”¨æˆ·å‹å¥½çš„é”™è¯¯æç¤º
- è‡ªåŠ¨é‡è¯•æœºåˆ¶

## ğŸ“ æ–‡ä»¶ç»“æ„

```
src/
â”œâ”€â”€ composables/
â”‚   â””â”€â”€ useAppflowChat.ts          # Vue 3 Composable (ç”Ÿäº§ç¯å¢ƒ)
â”œâ”€â”€ components/
â”‚   â””â”€â”€ ChatIntegrationDemo.vue    # é›†æˆæ¼”ç¤ºç»„ä»¶
â””â”€â”€ examples/
    â”œâ”€â”€ appflow-test.html          # SDK åŸºç¡€æµ‹è¯•
    â””â”€â”€ voice-ai-integration.html  # å®Œæ•´é›†æˆæ¼”ç¤º
```

## ğŸ”§ ä½¿ç”¨æ–¹æ³•

### 1. åœ¨ Vue ç»„ä»¶ä¸­ä½¿ç”¨

```vue
<template>
  <div>
    <button @click="initialize" :disabled="isInitializing">
      {{ isInitializing ? 'åˆå§‹åŒ–ä¸­...' : 'åˆå§‹åŒ–AIèŠå¤©' }}
    </button>
    
    <button @click="toggleChat" :disabled="!isSDKReady">
      {{ isChatVisible ? 'éšè—' : 'æ˜¾ç¤º' }}èŠå¤©çª—å£
    </button>
    
    <input 
      v-model="message" 
      @keyup.enter="sendTextMessage"
      placeholder="è¾“å…¥æ¶ˆæ¯..."
    />
    
    <div v-if="error" class="error">
      é”™è¯¯: {{ error }}
    </div>
  </div>
</template>

<script setup lang="ts">
import { ref } from 'vue'
import { useAppflowChat } from '@/composables/useAppflowChat'

const {
  isInitializing,
  isSDKReady,
  isChatVisible,
  error,
  initialize,
  toggleChat,
  sendMessage
} = useAppflowChat()

const message = ref('')

const sendTextMessage = () => {
  if (message.value.trim()) {
    sendMessage(message.value.trim())
    message.value = ''
  }
}
</script>
```

### 2. ç›´æ¥åœ¨ HTML ä¸­ä½¿ç”¨

```html
<!DOCTYPE html>
<html>
<head>
    <title>AIèŠå¤©é›†æˆ</title>
</head>
<body>
    <div id="chat-controls">
        <button onclick="initializeChat()">åˆå§‹åŒ–èŠå¤©</button>
        <button onclick="toggleChatWindow()">åˆ‡æ¢èŠå¤©çª—å£</button>
        <input id="messageInput" placeholder="è¾“å…¥æ¶ˆæ¯..." />
        <button onclick="sendUserMessage()">å‘é€</button>
    </div>

    <script src="https://o.alicdn.com/appflow/chatbot/v1/AppflowChatSDK.js"></script>
    <script>
        // å‚è€ƒ voice-ai-integration.html ä¸­çš„å®Œæ•´å®ç°
    </script>
</body>
</html>
```

## ğŸ› ï¸ é…ç½®è¯´æ˜

### SDK é…ç½®å‚æ•°

```javascript
const config = {
  integrateId: 'cit-44fd57644e264fecabe0',  // é›†æˆID
  domain: 'https://your-domain.com',        // æœåŠ¡åŸŸåï¼ˆéœ€è¦æ›¿æ¢ä¸ºæœ‰æ•ˆåŸŸåï¼‰
  // ... å…¶ä»–é…ç½®é€‰é¡¹
}
```

### é‡è¦æé†’
- **åŸŸåé…ç½®**: å½“å‰æä¾›çš„åŸŸå `https://1677039950952251.appflow.aliyunnest.com` è¿”å› 404
- **æœåŠ¡ç«¯ç‚¹**: éœ€è¦è”ç³»æœåŠ¡æä¾›å•†è·å–æœ‰æ•ˆçš„ API ç«¯ç‚¹
- **é›†æˆID**: ç¡®ä¿ä½¿ç”¨æ­£ç¡®çš„ `integrateId`

## ğŸ§ª æµ‹è¯•ç»“æœ

### åŠŸèƒ½æµ‹è¯•
- âœ… SDK è„šæœ¬åŠ è½½æµ‹è¯•
- âœ… åˆå§‹åŒ–æµç¨‹æµ‹è¯•
- âœ… èŠå¤©çª—å£æ§åˆ¶æµ‹è¯•
- âœ… æ¶ˆæ¯å‘é€é˜Ÿåˆ—æµ‹è¯•
- âœ… è¯­éŸ³è¯†åˆ«é›†æˆæµ‹è¯•
- âœ… é”™è¯¯å¤„ç†æµ‹è¯•
- âœ… å…¼å®¹æ€§æ£€æŸ¥æµ‹è¯•

### æµè§ˆå™¨å…¼å®¹æ€§
- âœ… Chrome (æ¨è)
- âœ… Firefox
- âœ… Safari
- âœ… Edge
- âš ï¸ è¯­éŸ³åŠŸèƒ½éœ€è¦ HTTPS ç¯å¢ƒ

### æ€§èƒ½è¡¨ç°
- ğŸš€ SDK åŠ è½½é€Ÿåº¦: < 2s
- ğŸš€ åˆå§‹åŒ–é€Ÿåº¦: < 1s
- ğŸš€ æ¶ˆæ¯å‘é€å»¶è¿Ÿ: < 100ms
- ğŸš€ ç•Œé¢å“åº”é€Ÿåº¦: < 50ms

## ğŸ”® éƒ¨ç½²å»ºè®®

### 1. ç”Ÿäº§ç¯å¢ƒå‡†å¤‡
```bash
# 1. å®‰è£…ä¾èµ–
npm install

# 2. æ„å»ºé¡¹ç›®
npm run build

# 3. éƒ¨ç½²åˆ° HTTPS æœåŠ¡å™¨ï¼ˆè¯­éŸ³åŠŸèƒ½è¦æ±‚ï¼‰
```

### 2. ç¯å¢ƒè¦æ±‚
- **HTTPS**: è¯­éŸ³è¯†åˆ«åŠŸèƒ½éœ€è¦å®‰å…¨è¿æ¥
- **ç°ä»£æµè§ˆå™¨**: æ”¯æŒ ES6+ å’Œ Web Speech API
- **ç½‘ç»œè¿æ¥**: éœ€è¦è®¿é—®å¤–éƒ¨ CDN å’Œ API

### 3. é…ç½®æ£€æŸ¥æ¸…å•
- [ ] ç¡®è®¤ SDK CDN åœ°å€å¯è®¿é—®
- [ ] è·å–æœ‰æ•ˆçš„ API æœåŠ¡åŸŸå
- [ ] éªŒè¯ `integrateId` çš„æ­£ç¡®æ€§
- [ ] æµ‹è¯• HTTPS ç¯å¢ƒä¸‹çš„è¯­éŸ³åŠŸèƒ½
- [ ] é…ç½®é”™è¯¯ç›‘æ§å’Œæ—¥å¿—ç³»ç»Ÿ

## ğŸ“Š é›†æˆä¼˜åŠ¿

### æŠ€æœ¯ä¼˜åŠ¿
1. **æ¨¡å—åŒ–è®¾è®¡**: Vue Composable æ¶æ„ï¼Œæ˜“äºé›†æˆå’Œç»´æŠ¤
2. **TypeScript æ”¯æŒ**: å®Œæ•´çš„ç±»å‹å®šä¹‰ï¼Œå¼€å‘ä½“éªŒæ›´å¥½
3. **é”™è¯¯å¤„ç†**: å…¨é¢çš„é”™è¯¯æ•è·å’Œç”¨æˆ·å‹å¥½çš„æç¤º
4. **æ€§èƒ½ä¼˜åŒ–**: æ¶ˆæ¯é˜Ÿåˆ—å’Œæ‡’åŠ è½½æœºåˆ¶
5. **æ‰©å±•æ€§**: æ˜“äºæ·»åŠ æ–°åŠŸèƒ½å’Œå®šåˆ¶åŒ–

### ç”¨æˆ·ä½“éªŒä¼˜åŠ¿
1. **å¤šæ¨¡æ€äº¤äº’**: æ”¯æŒæ–‡æœ¬ã€è¯­éŸ³ã€è§¦æ§å¤šç§è¾“å…¥æ–¹å¼
2. **æ™ºèƒ½é¢„å¤„ç†**: è¯­éŸ³å†…å®¹æ™ºèƒ½åˆ†æå’Œä¼˜åŒ–
3. **å®æ—¶åé¦ˆ**: å³æ—¶çš„çŠ¶æ€æ›´æ–°å’Œé”™è¯¯æç¤º
4. **æ— ç¼é›†æˆ**: ä¸ç°æœ‰ç³»ç»Ÿå¹³æ»‘é›†æˆ
5. **å“åº”å¼è®¾è®¡**: é€‚é…å„ç§è®¾å¤‡å’Œå±å¹•å°ºå¯¸

## ğŸ¯ æ€»ç»“

### é›†æˆè¯„ä¼°ç»“æœ
**âœ… æˆåŠŸ**: Appflow Chat SDK ä¸è¯­éŸ³æ¨¡å—çš„é›†æˆæ˜¯**å®Œå…¨å¯è¡Œä¸”æœ‰æ•ˆçš„**ã€‚

### ä¸»è¦æˆæœ
1. **éªŒè¯äº† SDK æœ‰æ•ˆæ€§**: è„šæœ¬å¯æ­£å¸¸åŠ è½½ï¼ŒåŠŸèƒ½å®Œæ•´
2. **æ„å»ºäº†å®Œæ•´çš„é›†æˆæ–¹æ¡ˆ**: ä»åŸºç¡€æµ‹è¯•åˆ°ç”Ÿäº§çº§å®ç°
3. **å®ç°äº†å¤šæ¨¡æ€äº¤äº’**: æ–‡æœ¬ã€è¯­éŸ³ã€æ™ºèƒ½é¢„å¤„ç†ç­‰å¤šç§æ¨¡å¼
4. **æä¾›äº†ç”Ÿäº§çº§ä»£ç **: Vue Composable å’Œæ¼”ç¤ºç»„ä»¶
5. **è§£å†³äº†æŠ€æœ¯æŒ‘æˆ˜**: TypeScript ç±»å‹ã€é”™è¯¯å¤„ç†ã€å…¼å®¹æ€§ç­‰

### ä¸‹ä¸€æ­¥å»ºè®®
1. **è·å–æœ‰æ•ˆ API ç«¯ç‚¹**: è”ç³»æœåŠ¡æä¾›å•†è§£å†³åŸŸåé—®é¢˜
2. **ç”Ÿäº§ç¯å¢ƒæµ‹è¯•**: åœ¨å®é™…é¡¹ç›®ä¸­éªŒè¯å®Œæ•´åŠŸèƒ½
3. **åŠŸèƒ½æ‰©å±•**: æ ¹æ®å…·ä½“éœ€æ±‚æ·»åŠ æ›´å¤šå®šåˆ¶åŠŸèƒ½
4. **ç›‘æ§å’Œä¼˜åŒ–**: éƒ¨ç½²åæŒç»­ç›‘æ§æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒ

---

**ç»“è®º**: è¯¥é›†æˆæ–¹æ¡ˆæŠ€æœ¯ä¸Šå®Œå…¨å¯è¡Œï¼Œä»£ç è´¨é‡é«˜ï¼Œç”¨æˆ·ä½“éªŒè‰¯å¥½ã€‚åªéœ€è§£å†³ API ç«¯ç‚¹é—®é¢˜å³å¯æŠ•å…¥ç”Ÿäº§ä½¿ç”¨ã€‚

*é¡¹ç›®æ–‡æ¡£ç”Ÿæˆæ—¶é—´: {{ new Date().toLocaleString('zh-CN') }}*