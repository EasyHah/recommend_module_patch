<template><div ref='el' :class="['echart',{fill}]" :style="fill?{}:{width:'100%',height:(height??220)+'px'}"></div></template><script setup lang='ts'>import * as echarts from 'echarts';import { ref,onMounted,onBeforeUnmount,watch } from 'vue';const props = defineProps<{ data:{name:string,value:number}[], colors?:string[], height?:number, fill?:boolean }>();const el = ref<HTMLDivElement|null>(null);let chart: echarts.ECharts|null=null;let ro: ResizeObserver|null=null;const resize=()=>chart?.resize();function render(){if(!chart) return;chart.setOption({tooltip:{trigger:'item'},legend:{bottom:0,textStyle:{color:'#fff'}},series:[{type:'pie',radius:['50%','70%'],label:{show:false},labelLine:{show:false},data:props.data}],color:props.colors??['#4C8BF5','#00BFA5','#FFC107','#E91E63']});}onMounted(()=>{chart=echarts.init(el.value!);render();window.addEventListener('resize',resize);ro=new ResizeObserver(resize);ro.observe(el.value!.parentElement||el.value!);});onBeforeUnmount(()=>{window.removeEventListener('resize',resize);ro?.disconnect();chart?.dispose();});watch(()=>props.data,render,{deep:true});</script><style scoped>.echart.fill{width:100%;height:100%;min-height:0}</style>